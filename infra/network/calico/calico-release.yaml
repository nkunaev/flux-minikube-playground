---
apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
  name: tigera-operator
  namespace: tigera-operator
spec:
  chart:
    spec:
      chart: tigera-operator
      version: '3.30.3'
      sourceRef:
        kind: HelmRelease
        name: projectcalico
        namespace: flux-system
  interval: 30s # 1h0m0s
  releaseName: tigera-operator
  timeout: 10m
  install:
    remediation:
      retries: 3
    crds: Create
  upgrade:
    remediation:
      retries: 3
    crds: CreateReplace
  values:
    installation:
      enabled: true
      cni:
        type: Calico
      calicoNetwork:
        bgp: Disabled
        ipPools:
        - cidr: 10.244.0.0/16
          encapsulation: VXLAN
    apiServer:
      enabled: true
    goldmane:
      enabled: true
    whisker:
      enabled: true
    defaultFelixConfiguration:
      enabled: false
    manageCRDs: true

    resources: {}

    tolerations:
    - effect: NoExecute
      operator: Exists
    - effect: NoSchedule
      operator: Exists

    nodeSelector:
      kubernetes.io/os: linux
